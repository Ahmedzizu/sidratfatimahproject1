// متغيرات الألوان
$primary-color: #D4AF37;
$secondary-color: #B38D46;
$dark-bg: #121212;
$card-bg: #1E1E1E;
$light-text: #F5F5F5;
$border-color: rgba(212, 175, 55, 0.3);
$error-color: #ff5252;
$success-color: #4caf50;
$input-bg-dark: rgba($light-text, 0.07);
$radio-checked-color: #D4AF37; // لون لأزرار الراديو المحددة

// أنيميشنات
@keyframes fadeInSlideUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(50px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes pulseButton {
    0% {
        transform: scale(1);
    }
    50% {
        transform: scale(1.02);
    }
    100% {
        transform: scale(1);
    }
}

@keyframes fadeAndScaleIn {
    from {
        opacity: 0;
        transform: scale(0.95);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes imageSlideFade {
    0% {
        opacity: 0;
        transform: translateX(-10%);
    }
    10% {
        opacity: 1;
        transform: translateX(0%);
    }
    90% {
        opacity: 1;
        transform: translateX(0%);
    }
    100% {
        opacity: 0;
        transform: translateX(10%);
    }
}

.reservation-chalet-container {
    background-color: $dark-bg;
    color: $light-text;
    font-family: 'Tajawal', sans-serif;
    padding: 40px 20px;
    animation: fadeInSlideUp 0.8s ease-out forwards;
    max-width: 1200px;
    margin: 0 auto;

    .image-slider-section {
        position: relative;
        width: 100%;
        height: 400px; // ارتفاع ثابت للسلايدر
        margin-bottom: 40px;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
        background-color: $card-bg; // خلفية للسلايدر

        .slider-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            animation: imageSlideFade 3s infinite; // أنيميشن الصور
        }

        .slider-dots {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 10;

            .dot {
                width: 12px;
                height: 12px;
                border-radius: 50%;
                background-color: rgba($light-text, 0.5);
                cursor: pointer;
                transition: all 0.3s ease;
                border: 1px solid rgba($primary-color, 0.3);

                &.active {
                    background-color: $primary-color;
                    transform: scale(1.2);
                    box-shadow: 0 0 8px rgba($primary-color, 0.7);
                }
            }
        }
    }


    .price-header-section {
        background-color: $card-bg;
        padding: 25px 30px;
        border-radius: 12px;
        margin-bottom: 40px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        border: 1px solid rgba($border-color, 0.4);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap; // السماح باللف على الشاشات الصغيرة

        h3 {
            color: $primary-color;
            font-size: 1.8rem;
            font-weight: 700;
            margin: 0;
            span {
                color: $light-text;
                font-weight: 900;
                font-size: 2rem;
                text-shadow: 0 0 10px rgba($primary-color, 0.5);
            }
        }

        .sub-prices {
            display: flex;
            gap: 20px;
            margin-top: 10px; // مسافة إذا لفت الأسطر
            flex-wrap: wrap;

            span {
                background-color: rgba($primary-color, 0.1);
                padding: 8px 15px;
                border-radius: 20px;
                color: $light-text;
                font-size: 0.95rem;
                border: 1px solid rgba($primary-color, 0.4);
            }
        }
    }

    .reservation-content-grid {
        display: grid;
        grid-template-columns: 2fr 1fr; // عمودان: حقول الإدخال أكبر من الملخص
        gap: 40px;
        margin-bottom: 60px; // مسافة من الخريطة/الفوتر

        .form-inputs-column {
            background-color: $card-bg;
            padding: 35px;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba($border-color, 0.5);

            .calendar-container {
                position: relative;
                margin-bottom: 25px; // مسافة من الحقل التالي

                .input-label-custom { // نمط الليبل المخصص
                    color: rgba($light-text, 0.9);
                    font-size: 1rem;
                    font-weight: 600;
                    margin-bottom: 10px;
                    display: block;
                    text-align: left;
                }

                .inputBox { // حقل تاريخ التقويم
                    .MuiOutlinedInput-root {
                        background-color: $input-bg-dark;
                        border-radius: 8px;
                        color: $light-text;
                        fieldset { border-color: rgba($border-color, 0.7); }
                        &:hover fieldset { border-color: rgba($primary-color, 0.7); }
                        &.Mui-focused fieldset {
                            border-color: $primary-color;
                            box-shadow: 0 0 0 3px rgba($primary-color, 0.3);
                        }
                    }
                    .MuiInputBase-input { padding: 14px 16px; }
                }

                .calendar { // التقويم نفسه
                    position: absolute;
                    z-index: 100;
                    background-color: $card-bg;
                    border: 1px solid $border-color;
                    border-radius: 12px;
                    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
                    top: calc(100% + 10px); // يظهر أسفل حقل التاريخ
                    left: 0;
                    right: 0;
                    width: fit-content; // ليتناسب مع محتوى التقويم
                    animation: fadeAndScaleIn 0.3s ease-out forwards; // أنيميشن ظهور

                    .rdrCalendarWrapper {
                        color: $light-text;
                        font-family: 'Tajawal', sans-serif;
                        .rdrDayNumber span { color: $light-text; }
                        .rdrDayDisabled { color: rgba($light-text, 0.4) !important; }
                        .rdrWeekDay { color: rgba($light-text, 0.7); }
                        .rdrSelected, .rdrInRange, .rdrStartEdge, .rdrEndEdge {
                            background-color: $primary-color !important;
                            color: $dark-bg !important;
                            border-color: $primary-color !important;
                            border-radius: 0 !important; // لإزالة التدوير غير المرغوب فيه
                        }
                        .rdrDayStartPreview, .rdrDayEndPreview {
                            background-color: rgba($primary-color, 0.2) !important;
                        }
                        .rdrDateDisplayWrapper { background-color: $dark-bg; }
                        .rdrMonthName { color: $primary-color; }
                        .rdrNextPrevButton { background: rgba($primary-color, 0.1) !important; color: $primary-color !important; }
                    }
                }
            }

            .MuiFormControl-root { // لكل حقل (TextField, Select)
                margin-top: 15px; // مسافة بين الحقول
                margin-bottom: 25px; // مسافة سفلية من كل حقل

                .MuiInputLabel-root {
                    color: rgba($light-text, 0.8) !important;
                    &.Mui-focused { color: $primary-color !important; }
                }
                .MuiOutlinedInput-root {
                    background-color: $input-bg-dark;
                    border-radius: 8px;
                    color: $light-text;
                    fieldset { border-color: rgba($border-color, 0.7); }
                    &:hover fieldset { border-color: rgba($primary-color, 0.7); }
                    &.Mui-focused fieldset {
                        border-color: $primary-color;
                        box-shadow: 0 0 0 3px rgba($primary-color, 0.3);
                    }
                }
                .MuiInputBase-input { padding: 14px 16px; }
                .MuiFormHelperText-root { color: $error-color; }
            }

            // أنماط خاصة بـ Select
            .MuiSelect-select {
                padding-right: 32px !important; // مسافة لأيقونة السهم
            }
            .MuiSvgIcon-root { // أيقونة السهم في Select
                color: rgba($light-text, 0.7);
            }

            // أنماط لأزرار الراديو
            .MuiFormGroup-root {
                gap: 20px;
                .MuiFormControlLabel-root {
                    .MuiRadio-root {
                        color: rgba($light-text, 0.6);
                        &.Mui-checked { color: $radio-checked-color; }
                    }
                    .MuiTypography-root { color: $light-text; }
                }
            }

            .error-text-bottom {
                color: $error-color;
                font-size: 0.75rem;
                margin-top: 4px;
                display: block; // لجعلها تأخذ سطر جديد
                text-align: left;
            }
            .period-section { // قسم الفترات الثابتة
                h3 {
                    color: $primary-color;
                    font-size: 1.2rem;
                    margin-bottom: 15px;
                    text-align: center;
                }
                .period-buttons {
                    display: flex;
                    gap: 10px;
                    flex-wrap: wrap; // السماح باللف
                    justify-content: center;

                    .period-btn {
                        background-color: rgba($primary-color, 0.1);
                        color: $light-text;
                        border: 1px solid rgba($primary-color, 0.4);
                        border-radius: 8px;
                        padding: 10px 15px;
                        font-weight: 500;
                        transition: all 0.3s ease;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 5px;

                        &:hover:not(.disabled) {
                            background-color: rgba($primary-color, 0.2);
                            transform: translateY(-2px);
                        }
                        &.active {
                            background-color: $primary-color;
                            color: $dark-bg;
                            box-shadow: 0 2px 8px rgba($primary-color, 0.4);
                            font-weight: 700;
                            .period-price, .period-time { color: $dark-bg; }
                        }
                        &.disabled {
                            opacity: 0.6;
                            cursor: not-allowed;
                            background-color: rgba($card-bg, 0.8);
                            border-color: rgba($border-color, 0.2);
                            .period-unavailable { color: $error-color; font-weight: 600; }
                        }

                        .period-label { font-size: 0.9rem; }
                        .period-price { font-size: 1rem; color: $primary-color; font-weight: 700; }
                        .period-time { font-size: 0.8rem; color: rgba($light-text, 0.7); }
                    }
                }
            }
        }

        .summary-column { // العمود الأيسر (الملخص)
            background-color: $card-bg;
            padding: 35px;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 1px solid rgba($border-color, 0.5);
            position: sticky; // لجعل الملخص ثابتًا عند التمرير
            top: 100px; // يبدأ من مسافة معينة من الأعلى
            height: fit-content; // ليتكيف مع المحتوى

            .summary-card { // حاوية الملخص الفعلية
                display: flex;
                flex-direction: column;
                gap: 25px;

                .date-box {
                    display: flex;
                    justify-content: space-around;
                    gap: 15px;
                    border-bottom: 1px dashed rgba($border-color, 0.5);
                    padding-bottom: 20px;
                    .date-field {
                        p {
                            margin: 0;
                            color: $light-text;
                            font-size: 1.1rem;
                            font-weight: 600;
                            &:first-child { color: $primary-color; font-size: 0.95rem; font-weight: 500; margin-bottom: 5px; }
                        }
                    }
                }

                .total-price-box {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    font-size: 1.4rem;
                    font-weight: 700;
                    color: $primary-color;
                    span {
                        font-size: 1.8rem;
                        font-weight: 900;
                        color: $light-text;
                        text-shadow: 0 0 8px rgba($primary-color, 0.5);
                    }
                    p { margin: 0; }
                }

                .reserve-btn {
                    background-color: $primary-color;
                    color: $dark-bg;
                    padding: 14px 20px;
                    border-radius: 8px;
                    font-size: 1.1rem;
                    font-weight: 700;
                    text-transform: uppercase;
                    letter-spacing: 0.8px;
                    transition: all 0.3s ease;
                    box-shadow: 0 5px 15px rgba($primary-color, 0.4);
                    width: 100%;
                    margin-top: 15px;

                    &:hover:not(:disabled) {
                        background-color: darken($primary-color, 5%);
                        transform: translateY(-3px);
                        box-shadow: 0 8px 20px rgba($primary-color, 0.6);
                    }
                    &:disabled {
                        opacity: 0.6;
                        cursor: not-allowed;
                        background-color: rgba($primary-color, 0.5);
                        box-shadow: none;
                    }
                }

                .installment-title {
                    color: rgba($light-text, 0.8);
                    font-size: 0.95rem;
                    margin-top: 20px;
                    margin-bottom: 15px;
                    text-align: center;
                }

                .installment-grid {
                    .installment-item {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 5px;
                        .installment-amount {
                            font-size: 0.9rem;
                            color: rgba($light-text, 0.7);
                        }
                    }
                }
            }
        }
    }


    /* RTL Adjustments */
    [dir="rtl"] {
        .price-header-section {
            h3 { text-align: right; }
            .sub-prices { justify-content: flex-end; }
        }
        .form-inputs-column {
            .calendar-container .inputBox { text-align: right; }
            .input-label-custom,
            .MuiFormControl-root .MuiInputLabel-root { text-align: right; }
            .MuiFormGroup-root .MuiFormControlLabel-root { margin-left: 0; margin-right: -11px; }
            .MuiRadio-root { padding-left: 0; padding-right: 9px; } // Adjust radio padding

            .period-section {
                h3 { text-align: center; }
                .period-buttons {
                    .period-btn {
                        .period-label, .period-unavailable { text-align: center; }
                        .period-time { text-align: center; }
                    }
                }
            }
            .error-text-bottom { text-align: right; }
        }

        .summary-column {
            .summary-card {
                .date-box {
                    .date-field {
                        p { text-align: right; }
                    }
                }
                .total-price-box {
                    flex-direction: row-reverse;
                }
            }
        }
    }


    /* Responsive Styles */
    @media (max-width: 992px) {
        .reservation-chalet-container {
            padding: 30px 15px;

            .price-header-section {
                flex-direction: column;
                align-items: flex-start;
                h3 { margin-bottom: 15px; }
                .sub-prices { justify-content: flex-start; margin-top: 0; }
            }

            .reservation-content-grid {
                grid-template-columns: 1fr; // عمود واحد
                gap: 30px;
            }
            .summary-column {
                position: static; // إلغاء sticky
                margin-top: 20px;
            }
        }
    }

    @media (max-width: 768px) {
        .reservation-chalet-container {
            .image-slider-section {
                height: 300px;
            }
            .price-header-section {
                padding: 20px;
                h3 { font-size: 1.6rem; span { font-size: 1.8rem; } }
            }
            .form-inputs-column {
                padding: 25px;
            }
            .summary-column {
                padding: 25px;
            }
        }
    }

    @media (max-width: 480px) {
        .reservation-chalet-container {
            padding: 20px 10px;

            .image-slider-section {
                height: 250px;
                margin-bottom: 30px;
            }
            .price-header-section {
                h3 { font-size: 1.4rem; span { font-size: 1.6rem; } }
                .sub-prices span { font-size: 0.85rem; padding: 6px 12px; }
            }
            .reservation-content-grid {
                gap: 20px;
            }
            .form-inputs-column {
                padding: 20px;
                .MuiFormControl-root { margin-top: 10px; margin-bottom: 15px; }
            }
            .summary-column {
                padding: 20px;
            }
        }
    }
}